<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
        integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

    <title>Subject Application list</title>
</head>

<body>
    <div class="container">

        <h2>Subject Application list</h2>

        <br> <br>
        <hr>
        <br> <br>

        <table class="table">
            <thead>
                <tr>
                	<th>ID</th>
                    <th>Student Name</th>
                    <th>Email</th>
                    <th>Major</th>
                    <th>GPA</th>
                    <th>Status</th>
                    <th>Date</th>
                    <th>Student id</th>
                    <th>Subject id</th>
                </tr>
            </thead>
            <tbody>
                <!-- Iterate over the list of items from Java code -->
                <tr th:each="item : ${items}">
                	<td th:text="${item.applicationid}"/>
                    <td th:text="${item.fullname}"/>
                    <td th:text="${item.email}"/>
                    <td th:text="${item.major}"/>
                    <td th:text="${item.gpa}"/>
                    <td th:text="${item.status}"/>
                    <td th:text="${item.applicationdate}"/>
                    <td th:text="${item.studentid}"/>
                    <td th:text="${item.subjectid}"/>
                </tr>
            </tbody>
        </table>

        <br> <br>
        <hr>
        <br> <br>

        <form id="strategyForm" action="#" th:action="@{/professor/application-strategy(subjectid=${subject.subjectid})}" method="post">
            <div class="form-group">
                <span class="ml-2">Select Best Applicant Strategy:</span>
                <select id="strategySelect" name="strategy" class="form-control">
                    <option value="default" name="strategy">Choose Strategy</option>
                    <option value="random_choice" name="strategy">Random choice</option>
                    <option value="best_avg_grade" name="strategy">Best average grade</option>
                    <option value="fewest_courses" name="strategy">Fewest courses remaining</option>
                    <option value="best_avg_courses" name="strategy">Best avg and courses</option>
                </select>
            </div>

            <div id="avgCoursesFields" class="form-group row" style="display: none;">
                <label for="avgGrade" class="col-sm-2 col-form-label">Average Grade:</label>
                <div class="col-sm-4">
                    <input type="number" step="0.1" min="0" max="10" name="avgGrade" class="form-control"
                        id="avgGrade" placeholder="Enter average grade" required>
                </div>
            
                <label for="coursesCompleted" class="col-sm-2 col-form-label">Courses Completed:</label>
                <div class="col-sm-4">
                    <input type="number" step="1" min="0" max="20" name="coursesCompleted" class="form-control"
                        id="coursesCompleted" placeholder="Enter number of courses completed" required>
                </div>
            </div>

            <div class="form-group row">
                <div class="col-sm-10 offset-sm-2">
                    <button type="submit" class="btn btn-primary">Submit</button>
                </div>
            </div>
        </form>

        <!-- "Back" button -->
        <a th:href<!-- "Back" button -->
            <a th:href="@{/professor/diploma-thesis-applications}" class="btn btn-secondary btn-sm mt-2">Back</a>
        </div>
		
        <br> <br>
        
        <span th:utext="${successMessage}"></span>
        
    </div>
</body>

<script>
    // Function to handle the visibility of the additional fields based on the selected option
    function handleStrategySelection() {
        var selectElement = document.getElementById("strategySelect");
        var selectedOption = selectElement.options[selectElement.selectedIndex].value;

        var avgCoursesFields = document.getElementById("avgCoursesFields");
        var avgGradeInput = document.getElementById("avgGrade");
        var coursesCompletedInput = document.getElementById("coursesCompleted");

        if (selectedOption === "best_avg_courses") {
            avgCoursesFields.style.display = "block"; // Show the additional fields
            avgGradeInput.required = true; // Make the input fields required
            coursesCompletedInput.required = true;
        } else {
            avgCoursesFields.style.display = "none"; // Hide the additional fields
            avgGradeInput.required = false; // Make the input fields not required
            coursesCompletedInput.required = false;
        }
    }

    // Add event listener to the strategy select element
    var strategySelect = document.getElementById("strategySelect");
    strategySelect.addEventListener("change", handleStrategySelection);
</script>

</html>
